# Somniverse - 꿈 기록 및 AI 기반 해몽/인사이트 도우미 웹 서비스

# I. 요구사항 정의

## 1) 타겟 사용자

- 자신의 꿈을 기록 및 관리하고 싶은 사람
- 꿈의 해몽이나 해석이 궁금한 사람(재미로)
- 타인과 꿈 이야기를 나누고, 공감받고 싶은 사람 (익명 기반)

## 2) 기능 정의(MVP)

- 사용자 인증:
    1. 회원가입
    2. 로그인
    3. 로그아웃
- 꿈 일기 관리(CRUD):
    1. 꿈 일기 작성(날짜, 내용, 공개 여부, 감정 태그, 요약, 해몽, ...)
    2. 꿈 일기 목록 조회
    3. 꿈 일기 상세 조회
    4. 꿈 일기 수정
    5. 꿈 일기 삭제
- AI 기능
    1. 꿈 내용 기반 태그 제공
    2. 간단 글 요약
    3. AI 해몽 도우미
- 관리자 기능
    1. 관리자 로그인
    2. 사용자 목록 조회 및 관리
    3. 부적절 컨텐츠 관리
    4. 사용 통계 조회

## 3) 유스케이스

### 사용자

| ID    | 기능         | 인수 조건 (Acceptance Criteria)                                                                                                                                           |
|-------|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| U-001 | 회원가입       | - 이메일, 비밀번호, 비밀번호 확인 필드 제공  <br> - 이메일 형식 유효성 검사  <br> - 비밀번호는 최소 길이 및 복잡도 조건 만족  <br> - 비밀번호와 확인 값이 일치  <br> - 성공 시 로그인 페이지 이동 또는 자동 로그인  <br> - 이미 사용 중인 이메일로 가입 불가 |
| U-002 | 로그인        | - 이메일, 비밀번호 필드 제공  <br> - 성공 시 꿈 일기 목록 페이지로 이동  <br> - 실패 시 에러 메시지 표시  <br> - 로그인 상태 유지 (예: JWT 사용)                                                                   |
| U-003 | 로그아웃       | - 로그아웃 버튼 제공  <br> - 로그아웃 시 상태 해제 및 로그인 페이지로 이동                                                                                                                       |
| U-004 | 꿈 일기 작성    | - 날짜 선택 가능  <br> - 꿈 내용 입력  <br> - 감정 태그 선택 또는 입력 가능  <br> - 공개 여부 설정 (MVP에선 비공개 고정 가능)  <br> - AI 태그 제안 기능 포함  <br> - 저장 후 목록 또는 상세 페이지로 이동                          |
| U-005 | 꿈 일기 목록 조회 | - 제목/내용 일부, 날짜, 감정 태그 표시  <br> - 항목 클릭 시 상세 페이지 이동  <br> - 페이지네이션 또는 일부만 표시 (MVP 단순화 가능)                                                                              |
| U-006 | 꿈 일기 상세 조회 | - 날짜, 내용, 감정 태그, 공개 여부 표시  <br> - AI 해몽 보기 버튼 제공  <br> - 수정/삭제 버튼 제공                                                                                                  |
| U-007 | 꿈 일기 수정    | - 작성 폼과 유사한 수정 UI  <br> - 날짜, 내용, 감정 태그, 공개 여부, AI 태그 수정 가능  <br> - 수정 후 상세 또는 목록 페이지로 이동                                                                             |
| U-008 | 꿈 일기 삭제    | - 삭제 전 확인 메시지 표시  <br> - 삭제 성공 시 목록에서 제거                                                                                                                              |
| U-009 | AI 태그 제안   | - 꿈 내용 입력 후 버튼 클릭 또는 자동으로 AI 추천 태그 표시  <br> - 추천 태그 선택 또는 직접 입력 가능  <br> - AI 처리 중 로딩 상태 표시                                                                           |
| U-010 | AI 해몽 보기   | - AI 해몽 보기 버튼 제공  <br> - 클릭 시 AI 해몽 내용 표시  <br> - 참고용 안내 문구 포함  <br> - AI 처리 중 로딩 상태 표시                                                                               |

### 관리자

| ID    | 기능             | 인수 조건 (Acceptance Criteria)                                                                                            |
|-------|----------------|------------------------------------------------------------------------------------------------------------------------|
| A-001 | 관리자 로그인        | - 일반 사용자와 다른 로그인 경로 또는 로그인 시 관리자임을 식별  <br> - 로그인 성공 시 관리자 대시보드로 이동  <br> - 관리자 계정은 사전 등록되어 있어야 함 (가입 불가)              |
| A-002 | 사용자 목록 조회      | - 사용자 ID, 이메일, 가입일, 계정 상태 표시  <br> - 이메일, 사용자 ID로 검색 및 정렬 가능  <br> - 페이지네이션 적용                                         |
| A-003 | 사용자 계정 상태 변경   | - 목록에서 사용자 선택 후 상태 변경 UI 제공  <br> - 상태 변경 시 사유 기록 가능 (선택 사항)  <br> - 상태 변경 즉시 반영 (예: 정지 시 로그인 불가)                      |
| A-004 | 공개된 꿈 일기 목록 조회 | - 꿈 일기 ID, 작성자 정보, 내용 일부, 작성일, 공개 상태 표시  <br> - 필터링 기능 제공 가능 (MVP에선 단순 목록)                                             |
| A-005 | 꿈 일기 확인 및 조치   | - 목록에서 특정 꿈 일기 선택하여 상세 내용 확인 가능  <br> - 비공개 처리 또는 삭제 기능 제공  <br> - 조치 사유 기록 가능 (선택 사항)  <br> - 사용자에게 조치 알림 가능 (MVP 이후) |

## 4) API 명세서

### I. 사용자 인증 (Auth)

| 기능          | 메서드    | Endpoint            | 설명                                 | 요청 항목 예시                                                                  | 응답 코드 및 설명                                  |
|-------------|--------|---------------------|------------------------------------|---------------------------------------------------------------------------|---------------------------------------------|
| 회원가입        | POST   | `/api/auth/members` | 사용자 계정 생성                          | - Body: `email`, `password`, `username`                                   | `201`: 성공<br>`400`: 유효성 오류<br>`409`: 중복 이메일 |
| 로그인 (토큰 발급) | POST   | `/api/auth/tokens`  | 로그인 후 액세스/리프레시 토큰 발급               | - Body: `email`, `password`                                               | `200`: 토큰 및 사용자 정보 반환<br>`401`: 인증 실패       |
| 로그아웃        | DELETE | `/api/auth/tokens`  | 로그아웃: 리프레시 토큰 폐기 + 액세스 토큰 블랙리스트 등록 | - Header: `Authorization: Bearer accessToken`<br>- Cookie: `refreshToken` | `204`: 성공<br>`401`: 인증 실패 또는 토큰 없음          |
| 토큰 재발급      | PUT    | `/api/auth/tokens`  | 리프레시 토큰을 이용해 새로운 액세스/리프레시 토큰 재발급   | - Cookie: `refreshToken`                                                  | `200`: 새 토큰 발급<br>`401`: 유효하지 않은 토큰         |

### II. 꿈 일기 (Dreams) - 인증 필요

| 기능            | 메서드    | Endpoint                        | 설명                                   | 요청 항목 예시                                                                 | 응답 코드 및 설명                                                                   |
|---------------|--------|---------------------------------|--------------------------------------|--------------------------------------------------------------------------|------------------------------------------------------------------------------|
| 꿈 일기 작성       | POST   | `/api/dreams`                   | 꿈 일기를 작성                             | - Body: `title`, `content`, `dreamDate`, `isPublic`                      | `201`: 등록 성공<br>`400`: 유효성 오류<br>`401`: 인증 실패                                |
| 꿈 일기 단건 조회    | GET    | `/api/dreams/{dreamId}`         | 특정 꿈 일기를 조회                          | - Path: `dreamId`                                                        | `200`: 성공<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음                  |
| 꿈 일기 수정       | PUT    | `/api/dreams/{dreamId}`         | 특정 꿈 일기를 수정                          | - Path: `dreamId`<br>- Body: `title`, `content`, `dreamDate`, `isPublic` | `200`: 성공<br>`400`: 유효성 오류<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음 |
| 꿈 일기 삭제       | DELETE | `/api/dreams/{dreamId}`         | 특정 꿈 일기를 삭제                          | - Path: `dreamId`                                                        | `204`: 삭제 성공<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음               |
| 내 꿈 목록 조회     | GET    | `/api/dreams/my`                | 로그인 사용자의 꿈 일기 목록 조회                  | - Query: `page`, `size`, `sort`                                          | `200`: 성공<br>`401`: 인증 실패                                                    |
| 내 꿈 단건 조회     | GET    | `/api/dreams/my/{dreamId}`      | 로그인 사용자의 특정 꿈 일기 조회                  | - Path: `dreamId`                                                        | `200`: 성공<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음                  |
| 공개 꿈 목록 조회    | GET    | `/api/dreams`                   | 전체 공개 꿈 일기 목록 조회                     | - Query: `page`, `size`, `sort`                                          | `200`: 성공                                                                    |
| 특정 유저 꿈 목록 조회 | GET    | `/api/dreams/member/{memberId}` | 특정 유저가 공개한 꿈 일기 목록 조회                | - Path: `memberId`<br>- Query: `page`, `size`, `sort`                    | `200`: 성공                                                                    |
| 관리자 꿈 목록 조회   | GET    | `/api/dreams/admin`             | 관리자가 전체 꿈 일기 목록 조회<br>(공개/비공개/삭제 포함) | - Query: `page`, `size`, `includeDeleted`                                | `200`: 성공<br>`401`: 인증 실패<br>`403`: 인가 실패                                    |
| 관리자 꿈 단건 조회   | GET    | `/api/dreams/admin/{dreamId}`   | 관리자가 특정 꿈 일기 조회<br>(공개/비공개/삭제 포함)    | - Path: `dreamId`<br>- Query: `includeDeleted`                           | `200`: 성공<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음                  |

### III. 댓글 기능 - 인증 필요

| 기능        | 메서드    | Endpoint                           | 설명                                                 | 요청 항목 예시                                                     | 응답 코드 및 설명                                                     |
|-----------|--------|------------------------------------|----------------------------------------------------|--------------------------------------------------------------|----------------------------------------------------------------|
| 댓글 작성     | POST   | `/api/dreams/{dreamId}/comments`   | 특정 꿈 일기에 댓글 작성                                     | - Path: `dreamId`<br>- Body: `content`                       | `201`: 등록 성공<br>`400`: 유효성 오류<br>`401`: 인증 실패                  |
| 댓글 목록 조회  | GET    | `/api/dreams/{dreamId}/comments`   | 특정 꿈 일기의 댓글 목록 조회 (페이징 처리)                         | - Path: `dreamId`<br>- Query: `page`, `size`, `sort`         | `200`: 성공                                                      |
| 댓글 수정     | PUT    | `/api/comments/{commentId}`        | 특정 댓글 수정                                           | - Path: `commentId`<br>- Body: `content`                     | `200`: 성공<br>`400`: 유효성 오류<br>`401`: 인증 실패<br>`403`: 인가 실패     |
| 댓글 삭제     | DELETE | `/api/comments/{commentId}`        | 특정 댓글 삭제                                           | - Path: `commentId`                                          | `204`: 삭제 성공<br>`401`: 인증 실패<br>`403`: 인가 실패<br>`404`: 존재하지 않음 |
| 대댓글 작성    | POST   | `/api/comments/{parentId}/replies` | 특정 댓글에 대한 대댓글(답글) 작성                               | - Path: `parentCommentId`<br>- Body: `content`               | `201`: 등록 성공<br>`400`: 유효성 오류<br>`401`: 인증 실패                  |
| 대댓글 목록 조회 | GET    | `/api/comments/{parentId}/replies` | 특정 댓글의 대댓글(답글) 목록 조회 (기본 몇 개 + '답글 더보기' 형식 페이징 처리) | - Path: `parentCommentId`<br>- Query: `page`, `size`, `sort` | `200`: 성공                                                      |

### IV. AI 부가 기능 - 인증 필요

| 기능       | 메서드  | Endpoint                  | 설명                | 요청 항목 예시                           | 응답 코드 및 설명                                             |
|----------|------|---------------------------|-------------------|------------------------------------|--------------------------------------------------------|
| 태그 제안    | POST | `/api/ai/suggest-tags`    | 꿈 내용 기반 태그 추천     | `dreamContent`                     | `200 OK`: `suggestedTags` 반환<br>`400/401`              |
| AI 해몽 요청 | POST | `/api/ai/interpret-dream` | 꿈 내용에 대한 AI 해석 요청 | `dreamContent`, `emotionTags (선택)` | `200 OK`: `interpretation`, `keywords` 반환<br>`400/401` |

### V. 관리자 기능 (Admin) - 관리자 권한 필요

| 기능        | 메서드 | Endpoint                           | 설명                  | 요청 항목 예시                                      | 응답 코드 및 설명                              |
|-----------|-----|------------------------------------|---------------------|-----------------------------------------------|-----------------------------------------|
| 사용자 목록 조회 | GET | `/api/admin/users`                 | 전체 사용자 목록 조회 (페이징)  | `page`, `size`, `sort` (query param)          | `200 OK`<br>`401/403`: 인증/권한 오류         |
| 사용자 상태 변경 | PUT | `/api/admin/users/{userId}/status` | 사용자 상태 변경 (예: 비활성화) | Path: `userId`, Body: `status`, `reason (선택)` | `200 OK`: 상태 변경 성공<br>`400/401/403/404` |

## 5) ERD

![Image](https://github.com/user-attachments/assets/c3f1d684-72e1-4dea-9672-b972841807a1)